<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    <title>Firebase firestore</title>
</head>
<body>
    <button id="btnAdd">ADD Face</button>
    <div id="demo"></div>

 

    <script type="module">
       
        //åŒ¯å…¥æ‰€éœ€è¦çš„å‡½æ•¸
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

        //æ–°å¢å…¶ä»–çš„SDK
        import { getFirestore,doc,getDoc,collection,getDocs,setDoc,addDoc} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        
      
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyAQ3yatJFv0IiezkRVl47MPaIWyyOuj68Q",
          authDomain: "jsdb202405.firebaseapp.com",
          projectId: "jsdb202405",
          storageBucket: "jsdb202405.appspot.com",
          messagingSenderId: "608554569857",
          appId: "1:608554569857:web:af20e8f497d4c67cd87d80"
        };
      
        // Firebase åˆå§‹åŒ–
        const app = initializeApp(firebaseConfig);       
        const db=getFirestore(app); //å»ºç«‹è³‡æ–™åº«ç‰©ä»¶å¸¸æ•¸

        const demo=document.getElementById("demo");
        const btnAdd=document.getElementById("btnAdd");

        btnAdd.onclick=function(){
            //addData();
            //setData();
            setData2();
        }


        //è®€å–è³‡æ–™
        //è®€å–ä¸€ç­†è³‡æ–™
        const docRef=doc(db,"EmojiText","01");
        const docSnap=await getDoc(docRef);
        //console.log(docSnap);
        //console.log(docSnap.data());

        if(docSnap.exists()){
            console.log(docSnap.data());
        }else{
            console.log("ç„¡æ­¤æ–‡ä»¶");
        }

        //---------------------------
        //è®€å–æ‰€æœ‰çš„è³‡æ–™
        const snap=await getDocs(collection(db,"EmojiText"));
        snap.forEach((doc)=>{
            console.log(doc.id,"=>",doc.data());
        });

         //è®€å–æ‰€æœ‰çš„è³‡æ–™
         snap.forEach((doc)=>{
            let data=doc.data();
            demo.innerHTML +=doc.id + "<br>";
            demo.innerHTML +="ç·¨è™Ÿï¼š" +data["faceId"] + "<br>";
            demo.innerHTML +="è¡¨æƒ…ï¼š" +data["face"] + "<br>";
            demo.innerHTML +="é¡åˆ¥ï¼š" +data["category"] + "<hr>";
         });

         //æ–°å¢æ–‡ä»¶
         //è‡ªå‹•ç”¢ç”Ÿæ–‡ä»¶id,addDoc()
         //await é‹ç®—å­å¯è¢«ç”¨ä¾†ç­‰å¾… Promise,åªèƒ½åœ¨async function å…§ä½¿ç”¨
        async function addData(){
            const docEmoji=await addDoc(collection(db,"EmojiText"),{
                faceId:6,
                face:"ğ“ˆ’@.@",
                category:"surprise"
            }).then(function(){
                demo.innerHTML="æ–°å¢æ–‡ä»¶OK<br>";
            });
         }

         //æ–°å¢æ–‡ä»¶
         //è‡ªå‹•ç”¢ç”Ÿæ–‡ä»¶id,setDoc()
         async function setData(){
            const docEmoji=doc(collection(db,"EmojiText"));
            let data={
                faceId:6,
                face:"â™¡âœ§Ëš à¼˜ â‹†ï½¡â™¡Ëš",
                category:"love"
            };
            await setDoc(docEmoji,data)
            .then(function(){
                demo.innerHTML="æ–°å¢æ–‡ä»¶OK<br>";
            })
         }

         //æ–°å¢æ–‡ä»¶
         //æ‰‹å‹•ç”¢ç”Ÿæ–‡ä»¶id,setDoc()
         async function setData2(){
            await setDoc(doc(db,"EmojiText","05"),{
                faceId:555,
                face:"~_~",
                category:"love"
            }).then(function(){
                demo.innerHTML="æ–°å¢æ–‡ä»¶OK<br>";
            });
         }



  
        
 

      </script>
     

    
</body>
</html>